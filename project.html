<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Name - Davis Tyler</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:opsz,wght@12..96,800;12..96,600;12..96,400&family=JetBrains+Mono:wght@400&display=swap" rel="stylesheet">
    <style>
        :root {
            --magenta: #E4007C;
            --yellow: #FFF700;
            --timing: cubic-bezier(0.22, 1, 0.36, 1);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: var(--magenta);
            color: var(--yellow);
            font-family: 'JetBrains Mono', monospace;
            overflow-x: hidden;
            cursor: crosshair;
        }
        
        ::selection {
            background: var(--yellow);
            color: var(--magenta);
        }
        
        .container {
            min-height: 100vh;
            padding: 6vw;
        }
        
        /* Navigation */
        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8vw;
            padding-bottom: 3vw;
            border-bottom: 2px solid var(--yellow);
            opacity: 0;
            animation: fadeIn 0.8s var(--timing) forwards;
        }
        
        .nav-logo {
            font-family: 'Bricolage Grotesque', sans-serif;
            font-size: clamp(1.2rem, 2.5vw, 1.8rem);
            font-weight: 800;
            text-decoration: none;
            color: var(--yellow);
            transition: opacity 0.3s ease;
        }
        
        .nav-logo:hover {
            opacity: 0.7;
        }
        
        .nav-back {
            font-size: clamp(0.7rem, 1.2vw, 0.85rem);
            text-decoration: none;
            color: var(--yellow);
            transition: transform 0.3s var(--timing);
            display: inline-block;
        }
        
        .nav-back:hover {
            transform: translateX(-5px);
        }
        
        /* Header */
        header {
            margin-bottom: 10vw;
            opacity: 0;
            animation: slideIn 1s var(--timing) 0.2s forwards;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(40px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes fadeIn {
            to { opacity: 1; }
        }
        
        .project-meta {
            display: flex;
            gap: 3rem;
            margin-bottom: 3rem;
            font-size: clamp(0.65rem, 1.2vw, 0.75rem);
            opacity: 0.7;
            flex-wrap: wrap;
        }
        
        .project-meta span {
            letter-spacing: 0.1em;
        }
        
        h1 {
            font-family: 'Bricolage Grotesque', sans-serif;
            font-size: clamp(3rem, 10vw, 8rem);
            font-weight: 800;
            line-height: 0.9;
            letter-spacing: -0.03em;
            margin-bottom: 2rem;
        }
        
        .project-intro {
            font-size: clamp(0.9rem, 1.8vw, 1.1rem);
            line-height: 1.7;
            max-width: 65ch;
            opacity: 0.9;
        }
        
        /* Sections */
        section {
            margin-bottom: 12vw;
            opacity: 0;
            animation: fadeIn 0.8s var(--timing) forwards;
        }
        
        section:nth-child(2) { animation-delay: 0.4s; }
        section:nth-child(3) { animation-delay: 0.5s; }
        section:nth-child(4) { animation-delay: 0.6s; }
        section:nth-child(5) { animation-delay: 0.7s; }
        section:nth-child(6) { animation-delay: 0.8s; }
        
        .section-label {
            font-family: 'Bricolage Grotesque', sans-serif;
            font-size: clamp(0.8rem, 1.5vw, 1rem);
            font-weight: 400;
            letter-spacing: 0.3em;
            opacity: 0.6;
            margin-bottom: 3vw;
        }
        
        h2 {
            font-family: 'Bricolage Grotesque', sans-serif;
            font-size: clamp(2rem, 5vw, 3.5rem);
            font-weight: 600;
            line-height: 1.1;
            margin-bottom: 2rem;
            letter-spacing: -0.02em;
        }
        
        p {
            font-size: clamp(0.8rem, 1.5vw, 0.95rem);
            line-height: 1.7;
            margin-bottom: 1.5rem;
            max-width: 70ch;
        }
        
        /* Image Grid */
        .image-grid {
            display: grid;
            gap: 3vw;
            margin-top: 4vw;
        }
        
        .image-grid.two-col {
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        }
        
        .image-wrapper {
            position: relative;
            overflow: hidden;
            border: 3px solid var(--yellow);
            aspect-ratio: 16/10;
            background: rgba(255, 247, 0, 0.05);
            transition: transform 0.5s var(--timing);
        }
        
        .image-wrapper:hover {
            transform: scale(0.98);
        }
        
        .image-wrapper.hero {
            aspect-ratio: 21/9;
            grid-column: 1 / -1;
        }
        
        .image-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: clamp(0.7rem, 1.2vw, 0.85rem);
            opacity: 0.3;
            font-family: 'Bricolage Grotesque', sans-serif;
            letter-spacing: 0.2em;
        }
        
        .image-wrapper img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .image-wrapper.contain img {
            object-fit: contain;
        }

        /* Details Grid */
        .details-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 4vw;
            margin-top: 3vw;
        }
        
        .detail-item h3 {
            font-family: 'Bricolage Grotesque', sans-serif;
            font-size: clamp(1rem, 1.8vw, 1.2rem);
            font-weight: 600;
            margin-bottom: 1rem;
            opacity: 0.8;
        }
        
        .detail-item ul {
            list-style: none;
        }
        
        .detail-item li {
            font-size: clamp(0.75rem, 1.4vw, 0.9rem);
            line-height: 1.8;
            opacity: 0.7;
        }
        
        .detail-item li::before {
            content: '→ ';
            opacity: 0.5;
        }
        
        /* Next Project */
        .next-project {
            border: 4px solid var(--yellow);
            padding: 6vw;
            cursor: pointer;
            transition: all 0.6s var(--timing);
            position: relative;
            overflow: hidden;
            text-decoration: none;
            display: block;
            color: var(--yellow);
        }
        
        .next-project::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: var(--yellow);
            transition: left 0.6s var(--timing);
            z-index: 0;
        }
        
        .next-project:hover::before {
            left: 0;
        }
        
        .next-project:hover {
            color: var(--magenta);
        }
        
        .next-project > * {
            position: relative;
            z-index: 1;
        }
        
        .next-label {
            font-size: clamp(0.65rem, 1.2vw, 0.75rem);
            opacity: 0.7;
            margin-bottom: 1rem;
            letter-spacing: 0.2em;
        }
        
        .next-title {
            font-family: 'Bricolage Grotesque', sans-serif;
            font-size: clamp(2.5rem, 6vw, 4.5rem);
            font-weight: 800;
            line-height: 0.95;
            letter-spacing: -0.02em;
        }
        
        /* Footer */
        footer {
            border-top: 2px solid var(--yellow);
            padding-top: 3rem;
            margin-top: 10vw;
            opacity: 0;
            animation: fadeIn 0.8s var(--timing) 1s forwards;
        }

        .footer-nav {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            font-size: clamp(0.9rem, 1.8vw, 1.2rem);
        }

        .footer-nav-main {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 2rem 3rem;
        }

        .footer-nav a {
            color: var(--yellow);
            text-decoration: none;
            position: relative;
            display: inline-block;
            transition: transform 0.3s var(--timing);
        }

        .footer-nav a:hover {
            transform: translateX(10px);
        }

        .footer-nav a::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--yellow);
            transition: width 0.4s var(--timing);
        }

        .footer-nav a:hover::after {
            width: 100%;
        }

        /* WebGL Viewer */
        .webgl-wrapper {
            position: relative;
            width: 100%;
            aspect-ratio: 21/9;
            border: 3px solid var(--yellow);
            background: var(--magenta);
            overflow: hidden;
            grid-column: 1 / -1;
        }

        .webgl-wrapper canvas {
            display: block;
            width: 100% !important;
            height: 100% !important;
        }

        .webgl-hint {
            position: absolute;
            bottom: 1.5rem;
            right: 1.5rem;
            font-size: clamp(0.55rem, 1vw, 0.7rem);
            letter-spacing: 0.2em;
            opacity: 0.5;
            pointer-events: none;
            transition: opacity 0.5s ease;
        }

        .webgl-wrapper.interacted .webgl-hint {
            opacity: 0;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 6vw 4vw;
            }
            
            nav {
                flex-direction: column;
                gap: 2rem;
                align-items: flex-start;
            }
            
            .project-meta {
                flex-direction: column;
                gap: 0.5rem;
            }
            
            .details-grid {
                grid-template-columns: 1fr;
            }
            
            .next-project {
                padding: 8vw 6vw;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <nav>
            <a href="index.html" class="nav-logo">DT</a>
            <a href="index.html" class="nav-back">← Back to Portfolio</a>
        </nav>
        
        <header>
            <div class="project-meta">
                <span>DESIGN · DEVELOPMENT</span>
                <span>CLIENT: LOREM IPSUM CO</span>
                <span>2024</span>
            </div>
            <h1>Digital Soft goods Development.</h1>
            <p class="project-intro">
                An ongoing documentation of my workflow, with emphasis on integrating modern digital tools.
            </p>
        </header>
        
        <section>
            <div class="image-grid">
                <div class="webgl-wrapper" id="webgl-container">
                    <span class="webgl-hint">DRAG TO ROTATE</span>
                </div>
            </div>
        </section>
        
        <section>
            <div class="image-grid two-col">
                <div class="image-wrapper contain">
                    <img src="images/projects/properfckinvestlad8212025 38 40_2.png" alt="Vest back 38/40">
                </div>
                <div class="image-wrapper contain">
                    <img src="images/projects/properfckinvestlad8212025 38 40_1.png" alt="Vest front 38/40">
                </div>
            </div>
        </section>

        <section>
            <div class="section-label">OVERVIEW</div>
            <h2>Duis aute irure dolor</h2>
            <p>
                Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut
                labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco
                laboris nisi ut aliquip ex ea commodo consequat.
            </p>
            <p>
                Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla
                pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt
                mollit anim id est laborum.
            </p>
        </section>
        
        <section>
            <div class="section-label">APPROACH</div>
            <h2>Sed ut perspiciatis</h2>
            <p>
                Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, 
                totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae 
                dicta sunt explicabo.
            </p>
            <p>
                Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit, sed quia consequuntur 
                magni dolores eos qui ratione voluptatem sequi nesciunt.
            </p>
            
            <div class="details-grid">
                <div class="detail-item">
                    <h3>Tools & Technologies</h3>
                    <ul>
                        <li>Figma / Sketch</li>
                        <li>React / Next.js</li>
                        <li>GSAP Animation</li>
                        <li>Three.js / WebGL</li>
                    </ul>
                </div>
                
                <div class="detail-item">
                    <h3>Deliverables</h3>
                    <ul>
                        <li>Brand Guidelines</li>
                        <li>Design System</li>
                        <li>Web Application</li>
                        <li>Documentation</li>
                    </ul>
                </div>
                
                <div class="detail-item">
                    <h3>Timeline</h3>
                    <ul>
                        <li>Discovery: 2 weeks</li>
                        <li>Design: 4 weeks</li>
                        <li>Development: 8 weeks</li>
                        <li>Launch: Q4 2024</li>
                    </ul>
                </div>
            </div>
        </section>

        <section>
            <div class="image-grid two-col">
                <div class="image-wrapper">
                    <img src="images/projects/PaulKalifatidi_LOAMShopVisit-6614.jpg" alt="LOAM Shop Visit">
                </div>
                <div class="image-wrapper">
                    <img src="images/projects/PaulKalifatidi_LOAMShopVisit-6617.jpg" alt="LOAM Shop Visit">
                </div>
                <div class="image-wrapper">
                    <img src="images/projects/PaulKalifatidi_LOAMShopVisit-6618.jpg" alt="LOAM Shop Visit">
                </div>
                <div class="image-wrapper">
                    <img src="images/projects/PaulKalifatidi_LOAMShopVisit-6622.jpg" alt="LOAM Shop Visit">
                </div>
            </div>
        </section>

        <section>
            <div class="image-grid">
                <div class="image-wrapper hero contain">
                    <img src="images/projects/Screenshot 2026-02-23 at 11.01.34 PM.png" alt="Vest pattern pieces">
                </div>
            </div>
        </section>
        
        <section>
            <div class="section-label">RESULTS</div>
            <h2>Neque porro quisquam</h2>
            <p>
                At vero eos et accusamus et iusto odio dignissimos ducimus qui blanditiis praesentium voluptatum 
                deleniti atque corrupti quos dolores et quas molestias excepturi sint occaecati cupiditate non 
                provident, similique sunt in culpa qui officia deserunt mollitia animi.
            </p>
            <p>
                Temporibus autem quibusdam et aut officiis debitis aut rerum necessitatibus saepe eveniet ut et 
                voluptates repudiandae sint et molestiae non recusandae.
            </p>
        </section>
        
        <section>
            <a href="#" class="next-project">
                <div class="next-label">NEXT PROJECT</div>
                <h2 class="next-title">Excepteur Sint Occaecat</h2>
            </a>
        </section>
        
        <footer>
            <div class="footer-nav">
                <div class="footer-nav-main">
                    <a href="./archive.html">Projects</a>
                    <a href="#trips">Trips</a>
                    <a href="#photography">Photography</a>
                    <a href="#resources">Resources</a>
                    <a href="./archive.html">Archive</a>
                </div>
                <div class="footer-nav-main">
                    <a href="./">Home</a>
                    <a href="./archive.html">Projects</a>
                    <a href="#trips">Trips</a>
                    <a href="#photography">Photography</a>
                </div>
            </div>
        </footer>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/OBJLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script>
        (function () {
            const wrapper = document.getElementById('vest-viewer-wrapper');
            const canvas  = document.getElementById('vest-viewer');

            // ── Renderer ──────────────────────────────────────────────
            const renderer = new THREE.WebGLRenderer({ canvas, antialias: true, alpha: true });
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
            renderer.setClearColor(0x000000, 0);

            // ── Scene & Camera ────────────────────────────────────────
            const scene  = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera(45, 1, 0.01, 1000);
            camera.position.set(0, 0, 3);

            // ── Lighting ──────────────────────────────────────────────
            const ambient = new THREE.AmbientLight(0xffffff, 0.6);
            scene.add(ambient);

            const key = new THREE.DirectionalLight(0xffffff, 1.2);
            key.position.set(2, 3, 4);
            scene.add(key);

            const fill = new THREE.DirectionalLight(0xffffff, 0.4);
            fill.position.set(-3, -1, -2);
            scene.add(fill);

            const rim = new THREE.DirectionalLight(0xffffff, 0.3);
            rim.position.set(0, -3, -3);
            scene.add(rim);

            // ── Controls ──────────────────────────────────────────────
            const controls = new THREE.OrbitControls(camera, canvas);
            controls.enableDamping    = true;
            controls.dampingFactor    = 0.08;
            controls.autoRotate       = true;
            controls.autoRotateSpeed  = 1.2;
            controls.enablePan        = false;
            controls.minDistance      = 0.5;
            controls.maxDistance      = 10;

            // Stop auto-rotate on user interaction, resume after
            controls.addEventListener('start', () => controls.autoRotate = false);

            // ── Material ──────────────────────────────────────────────
            const material = new THREE.MeshStandardMaterial({
                color:     0xcccccc,
                metalness: 0.1,
                roughness: 0.6,
            });

            // ── Load OBJ ──────────────────────────────────────────────
            // Place vest_test_render.obj in the same directory as this HTML file
            const loader = new THREE.OBJLoader();
            loader.load(
                './vest_test_render.obj',
                function (obj) {
                    // Apply material to all meshes
                    obj.traverse(child => {
                        if (child.isMesh) child.material = material;
                    });

                    // Centre and scale to fit view
                    const box    = new THREE.Box3().setFromObject(obj);
                    const centre = box.getCenter(new THREE.Vector3());
                    const size   = box.getSize(new THREE.Vector3());
                    const maxDim = Math.max(size.x, size.y, size.z);
                    const scale  = 2 / maxDim;

                    obj.position.sub(centre.multiplyScalar(scale));
                    obj.scale.setScalar(scale);

                    scene.add(obj);
                },
                function (xhr) {
                    // loading progress — optional
                },
                function (err) {
                    console.warn('OBJ load error:', err);
                }
            );

            // ── Resize ────────────────────────────────────────────────
            function resize() {
                const w = wrapper.clientWidth;
                const h = wrapper.clientHeight;
                renderer.setSize(w, h, false);
                camera.aspect = w / h;
                camera.updateProjectionMatrix();
            }
            resize();
            new ResizeObserver(resize).observe(wrapper);

            // ── Render loop ───────────────────────────────────────────
            function animate() {
                requestAnimationFrame(animate);
                controls.update();
                renderer.render(scene, camera);
            }
            animate();
        })();
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
    (function () {
        const container = document.getElementById('webgl-container');

        // --- Renderer ---
        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        renderer.setClearColor(0x000000, 0);
        container.appendChild(renderer.domElement);

        // --- Scene & Camera ---
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(45, 1, 0.01, 1000);

        // --- Lights ---
        const ambient = new THREE.AmbientLight(0xffffff, 0.5);
        scene.add(ambient);
        const dirA = new THREE.DirectionalLight(0xffffff, 1.0);
        dirA.position.set(1, 2, 2);
        scene.add(dirA);
        const dirB = new THREE.DirectionalLight(0xffffff, 0.4);
        dirB.position.set(-2, -1, -1);
        scene.add(dirB);

        // --- Parse MTL ---
        function parseMTL(text) {
            const materials = {};
            let current = null;
            for (const rawLine of text.split('\n')) {
                const line = rawLine.trim();
                if (line.startsWith('newmtl ')) {
                    current = line.slice(7).trim();
                    materials[current] = {};
                } else if (current) {
                    const parts = line.split(/\s+/);
                    if (parts[0] === 'Kd') materials[current].Kd = [parseFloat(parts[1]), parseFloat(parts[2]), parseFloat(parts[3])];
                    if (parts[0] === 'Ks') materials[current].Ks = [parseFloat(parts[1]), parseFloat(parts[2]), parseFloat(parts[3])];
                    if (parts[0] === 'Ns') materials[current].Ns  = parseFloat(parts[1]);
                }
            }
            return materials;
        }

        // --- Parse OBJ with per-material groups ---
        function parseOBJ(text) {
            const positions = [], normals = [];
            const groups = {};
            let currentMat = '__default__';

            for (const rawLine of text.split('\n')) {
                const line = rawLine.trim();
                if (line.startsWith('v ')) {
                    const [, x, y, z] = line.split(/\s+/);
                    positions.push(parseFloat(x), parseFloat(y), parseFloat(z));
                } else if (line.startsWith('vn ')) {
                    const [, x, y, z] = line.split(/\s+/);
                    normals.push(parseFloat(x), parseFloat(y), parseFloat(z));
                } else if (line.startsWith('usemtl ')) {
                    currentMat = line.slice(7).trim();
                    if (!groups[currentMat]) groups[currentMat] = { posOut: [], normOut: [] };
                } else if (line.startsWith('f ')) {
                    if (!groups[currentMat]) groups[currentMat] = { posOut: [], normOut: [] };
                    const parts = line.slice(2).trim().split(/\s+/);
                    for (let i = 1; i < parts.length - 1; i++) {
                        [parts[0], parts[i], parts[i + 1]].forEach(part => {
                            const segs = part.split('/');
                            const vi = (parseInt(segs[0]) - 1) * 3;
                            groups[currentMat].posOut.push(positions[vi], positions[vi+1], positions[vi+2]);
                            if (segs[2]) {
                                const ni = (parseInt(segs[2]) - 1) * 3;
                                groups[currentMat].normOut.push(normals[ni], normals[ni+1], normals[ni+2]);
                            }
                        });
                    }
                }
            }
            return groups;
        }

        // --- Load MTL + OBJ ---
        Promise.all([
            fetch('./vest_test_render.mtl').then(r => r.text()),
            fetch('./vest_test_render.obj').then(r => r.text())
        ]).then(([mtlText, objText]) => {
            const mtlMap = parseMTL(mtlText);
            const groups = parseOBJ(objText);

            const group = new THREE.Group();
            for (const [matName, { posOut, normOut }] of Object.entries(groups)) {
                if (!posOut.length) continue;
                const geo = new THREE.BufferGeometry();
                geo.setAttribute('position', new THREE.Float32BufferAttribute(posOut, 3));
                if (normOut.length) geo.setAttribute('normal', new THREE.Float32BufferAttribute(normOut, 3));
                else geo.computeVertexNormals();

                const def = mtlMap[matName] || {};
                const kd  = def.Kd || [0.8, 0.8, 0.8];
                const ks  = def.Ks || [0, 0, 0];
                const ns  = def.Ns !== undefined ? def.Ns : 30;
                const mat = new THREE.MeshPhongMaterial({
                    color:    new THREE.Color(kd[0], kd[1], kd[2]),
                    specular: new THREE.Color(ks[0], ks[1], ks[2]),
                    shininess: ns,
                    side: THREE.DoubleSide,
                });
                group.add(new THREE.Mesh(geo, mat));
            }

            // Centre and scale
            const box = new THREE.Box3().setFromObject(group);
            const center = new THREE.Vector3();
            box.getCenter(center);
            group.position.sub(center);
            const size = new THREE.Vector3();
            box.getSize(size);
            const maxDim = Math.max(size.x, size.y, size.z);
            scene.add(group);

            camera.position.set(0, 0, maxDim * 1.6);
            camera.near = maxDim * 0.001;
            camera.far  = maxDim * 10;
            camera.updateProjectionMatrix();
        }).catch(() => {
            const geo = new THREE.BoxGeometry(1, 1.4, 0.2);
            const mat = new THREE.MeshPhongMaterial({ color: 0xcccccc, specular: 0xffffff, shininess: 40 });
            scene.add(new THREE.Mesh(geo, mat));
            camera.position.set(0, 0, 3);
        });

        // --- Drag-to-rotate ---
        let isDragging = false;
        let prevX = 0, prevY = 0;
        let rotX = 0, rotY = 0;
        let velX = 0, velY = 0;
        let autoRotate = true;

        container.addEventListener('mousedown', e => {
            isDragging = true; autoRotate = false;
            prevX = e.clientX; prevY = e.clientY;
            container.classList.add('interacted');
        });
        window.addEventListener('mousemove', e => {
            if (!isDragging) return;
            velY = (e.clientX - prevX) * 0.005;
            velX = (e.clientY - prevY) * 0.005;
            rotY += velY; rotX += velX;
            prevX = e.clientX; prevY = e.clientY;
        });
        window.addEventListener('mouseup', () => { isDragging = false; });

        // Touch
        let prevTX = 0, prevTY = 0;
        container.addEventListener('touchstart', e => {
            autoRotate = false;
            prevTX = e.touches[0].clientX;
            prevTY = e.touches[0].clientY;
            container.classList.add('interacted');
        });
        container.addEventListener('touchmove', e => {
            velY = (e.touches[0].clientX - prevTX) * 0.005;
            velX = (e.touches[0].clientY - prevTY) * 0.005;
            rotY += velY; rotX += velX;
            prevTX = e.touches[0].clientX;
            prevTY = e.touches[0].clientY;
            e.preventDefault();
        }, { passive: false });

        // --- Resize ---
        function resize() {
            const w = container.clientWidth;
            const h = container.clientHeight;
            renderer.setSize(w, h, false);
            camera.aspect = w / h;
            camera.updateProjectionMatrix();
        }
        new ResizeObserver(resize).observe(container);
        resize();

        // --- Render loop ---
        function animate() {
            requestAnimationFrame(animate);
            if (autoRotate) {
                rotY += 0.003;
            } else if (!isDragging) {
                velX *= 0.92; velY *= 0.92;
                rotX += velX; rotY += velY;
                if (Math.abs(velX) < 0.0001 && Math.abs(velY) < 0.0001) autoRotate = true;
            }
            scene.rotation.x = rotX;
            scene.rotation.y = rotY;
            renderer.render(scene, camera);
        }
        animate();
    })();
    </script>
</body>
</html>
